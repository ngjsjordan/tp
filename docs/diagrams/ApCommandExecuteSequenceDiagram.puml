@startuml
!include style.puml
skinparam ArrowFontStyle plain

box Logic LOGIC_COLOR_T1
participant ":AddAppointmentCommand" as AddAppointmentCommand LOGIC_COLOR
participant "res:CommandResult" as CommandResult LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
participant "model:Model" as Model MODEL_COLOR
participant "lastShownList:ObservableList<Person>" as LastShownList MODEL_COLOR
participant "appointment:Appointment" as Appointment MODEL_COLOR
end box

[-> AddAppointmentCommand : execute(model)
activate AddAppointmentCommand

AddAppointmentCommand -> Model : get last shown person list
activate Model

Model --> AddAppointmentCommand : lastShownList
deactivate Model

AddAppointmentCommand -> AddAppointmentCommand : getAppointment
activate AddAppointmentCommand

AddAppointmentCommand -> LastShownList : get person at seller index
activate LastShownList

LastShownList --> AddAppointmentCommand : seller
deactivate LastShownList

opt buyer is not null

AddAppointmentCommand -> LastShownList : get person at buyer index
activate LastShownList

LastShownList --> AddAppointmentCommand : buyer
deactivate LastShownList

end opt

AddAppointmentCommand -> Appointment ** : create
activate Appointment

Appointment --> AddAppointmentCommand : appointment
deactivate Appointment

AddAppointmentCommand --> AddAppointmentCommand : appointment
deactivate AddAppointmentCommand

AddAppointmentCommand -> Model : add appointment
activate Model

Model --> AddAppointmentCommand
deactivate Model

AddAppointmentCommand -> CommandResult ** : create
activate CommandResult

CommandResult --> AddAppointmentCommand : res
deactivate CommandResult

AddAppointmentCommand -->[ : res
deactivate AddAppointmentCommand

destroy AddAppointmentCommand

@enduml
